---
export interface Props {
  href: string;
  isSelected?: boolean;
  tabId: string;
}

const { href, isSelected = false, tabId } = Astro.props;
---
//TODO: Ajustar los colores con relaci√≥n al tema de la app
<nav>
  <a 
    id={tabId}
    href={href}
    class={`tab p-3 relative text-lg font-medium after:absolute after:bottom-[-2px] after:left-0 after:h-0.5 after:w-0 after:bg-sky-700 after:transition-all after:duration-300 hover:after:w-full ${isSelected ? 'text-sky-700 font-semibold' : 'text-black'}`}
    data-selected={isSelected ? 'true' : 'false'}
  >
    <slot />
    <div class={`after absolute bottom-[-2px] left-0 h-0.5 transition-all duration-300 ${isSelected ? 'w-full bg-sky-700' : 'w-0 bg-sky-700'}`}></div>
  </a>
</nav>

<script>
  const tabs = document.querySelectorAll<HTMLAnchorElement>('.tab');
  
  tabs.forEach(tab => {
    tab.addEventListener('click', function(this: HTMLAnchorElement, e: MouseEvent) {
      e.preventDefault();
      
      tabs.forEach(t => {
        t.classList.remove('text-sky-700');
        t.classList.add('text-black');
        t.setAttribute('data-selected', 'false');
        
        const indicator = t.querySelector<HTMLDivElement>('.after');
        if (indicator) {
          indicator.classList.remove('w-full');
          indicator.classList.add('w-0');
        }
      });
      
      this.classList.remove('text-black');
      this.classList.add('text-sky-700');
      this.setAttribute('data-selected', 'true');
      
      const currentIndicator = this.querySelector<HTMLDivElement>('.after');
      if (currentIndicator) {
        currentIndicator.classList.remove('w-0');
        currentIndicator.classList.add('w-full');
      }
      
      const event = new CustomEvent('tabSelected', { 
        detail: { tabId: this.id },
        bubbles: true 
      });
      this.dispatchEvent(event);
    });
  });
</script>